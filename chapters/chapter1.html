<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>قراءة الفصل – الفصل الأول</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- خط عربي فخم -->
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.10.1/lottie.min.js"></script>
  <link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
  integrity="sha512-pbF5X0FvCm8YbZSLfuNIc6U6VJohnsonVXG+YypFh9V+2fUm1kpz8+FZerpmXl15kd2Zjl1FKwIkHMDv6m0cw=="
  crossorigin="anonymous"
  referrerpolicy="no-referrer"
/>
  <style>
    :root {
  --bg-color:   #f9fafb;
  --text-color: #1f2937;
  --font-size:  18px;
  --font-family: 'Cairo', sans-serif; /* القيمة الافتراضية */
}

body {
  font-family: var(--font-family);
  background-color: var(--bg-color);
  color:            var(--text-color);
  font-size:        var(--font-size);
  transition: background 0.3s, color 0.3s, font-size 0.3s, font-family 0.3s;
  }
    /* بعد: تنسيقات Lottie */
    .lottie-icon {
      width: 32px;
      height: 32px;
    }
    /* عند تفعيل زرّ التنسيق يضيف خلفية فاتحة وحزام */
.active-btn {
  @apply bg-indigo-100 ring-2 ring-indigo-300;
}
  </style>
</head>
<body class="relative overflow-x-hidden">
  <!-- شريط التقدم -->
  <div id="progress" class="fixed top-0 left-0 h-1 bg-gradient-to-r from-indigo-500 to-pink-500 z-50" style="width:0"></div>  <!-- الصندوق الرئيسي -->  <div class="max-w-full max-h-screen mx-auto px-4 py-12 overflow-y-auto">
    <!-- العنوان -->
    <h1 class="text-center text-4xl font-extrabold mb-6 animate-gradient" style="font-family: 'Cairo', sans-serif;">
      الفصل الأول: عنوان الفصل هنا
    </h1>
    <div class="divider h-px bg-gradient-to-r from-transparent via-gray-300 to-transparent my-6"></div><!-- زر إعدادات القارئ -->
<div class="flex justify-center mb-8">
  <button id="open-settings"
          class="px-6 py-3 rounded-full shadow-md hover:shadow-lg transition bg-indigo-500 text-white no-select">
    إعدادات القارئ
  </button>
</div>

<!-- المحتوى -->
<div id="content" class="frame chapter-content no-select whitespace-pre-wrap break-words">
  <p>الفصل الأول</p>
  <p>[من وجهة نظر البطل]</p>
  <p>أنا في ورطة. أنا في ورطة حقيقية.</p>
</div>

<div class="divider h-px bg-gradient-to-r from-transparent via-gray-300 to-transparent my-6"></div>

<!-- تفاعلات الإيموجي: أضفنا flex-wrap لالتفاف ذكي بدل التمرير الأفقي -->
<div class="flex flex-wrap justify-center gap-4 mt-6">
  <!-- زر Like -->
  <button class="react-btn flex items-center gap-1 px-3 py-2 rounded-full shadow hover:shadow-md transition select-none" data-reaction="like">
    <div id="like-lottie" class="lottie-icon"></div>
    <span class="count">0</span>
  </button>

  <!-- زر Love -->
  <button class="react-btn flex items-center gap-1 px-3 py-2 rounded-full shadow hover:shadow-md transition select-none" data-reaction="love">
    <div id="love-lottie" class="lottie-icon"></div>
    <span class="count">0</span>
  </button>

  <!-- زر Haha -->
  <button class="react-btn flex items-center gap-1 px-3 py-2 rounded-full shadow hover:shadow-md transition select-none" data-reaction="haha">
    <div id="haha-lottie" class="lottie-icon"></div>
    <span class="count">0</span>
  </button>

  <!-- زر Sad -->
  <button class="react-btn flex items-center gap-1 px-3 py-2 rounded-full shadow hover:shadow-md transition select-none" data-reaction="sad">
    <div id="sad-lottie" class="lottie-icon"></div>
    <span class="count">0</span>
  </button>

  <!-- زر Angry -->
  <button class="react-btn flex items-center gap-1 px-3 py-2 rounded-full shadow hover:shadow-md transition select-none" data-reaction="angry">
    <div id="angry-lottie" class="lottie-icon"></div>
    <span class="count">0</span>
  </button>
    </div>

  </div> <!-- نهاية الصندوق الرئيسي -->  <!-- مودال إعدادات القارئ -->  <div id="reader-settings-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white text-gray-900 rounded-xl p-6 shadow-lg w-80 max-w-full">
      <!-- رأس المودال -->
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-lg font-semibold">إعدادات القارئ</h2>
        <button id="close-settings" class="text-gray-500 hover:text-gray-700 text-xl leading-none">&times;</button>
      </div>
      <!-- اختيار الثيم -->
      <div class="flex flex-wrap gap-2 mb-4 justify-center">
        <button onclick="setTheme('')" class="px-3 py-1 rounded-full border">عادي</button>
        <button onclick="setTheme('dark')" class="px-3 py-1 rounded-full bg-black text-white">أسود</button>
        <button onclick="setTheme('brown')" class="px-3 py-1 rounded-full bg-amber-200">بني</button>
        <button onclick="setTheme('blue')" class="px-3 py-1 rounded-full bg-blue-200">أزرق</button>
        <button onclick="setTheme('green')" class="px-3 py-1 rounded-full bg-green-200">أخضر</button>
        <button onclick="setTheme('pink')" class="px-3 py-1 rounded-full bg-pink-200">زهري</button>
        <button onclick="setTheme('purple')" class="px-3 py-1 rounded-full bg-purple-200">أرجواني</button>
      </div>
      <!-- منسدلات الإعداد -->
      <div class="space-y-3 mb-4">
        <div>
          <label class="block text-sm mb-1">نوع الخط</label>
<select onchange="document.documentElement.style.setProperty('--font-family', this.value)" class="w-full p-2 border rounded">
  <option value="system-ui, sans-serif">خط المتصفح</option>
  <option value="'Cairo', sans-serif" selected>خط كايرو</option>
  <option value="'Amiri', serif">خط الأميرى</option>
  <option value="'Tajawal', sans-serif">خط تجول</option>
  </select>
        </div>
          <!-- حجم الخط -->
  <div>
    <label class="block text-sm mb-1">حجم الخط</label>
    <select onchange="setFontSize(this.value)" class="w-full p-2 border rounded">
      <option value="16px">90%</option>
      <option value="18px" selected>100%</option>
      <option value="22px">125%</option>
      <option value="26px">150%</option>
    </select>
  </div>
        <div>
          <label class="block text-sm mb-1">ارتفاع الخط</label>
          <select onchange="document.documentElement.style.setProperty('line-height', this.value)" class="w-full p-2 border rounded">
            <option value="1.2">120%</option>
            <option value="1.6" selected>160%</option>
            <option value="2.0">200%</option>
          </select>
        </div>
        <div>
          <label class="block text-sm mb-1">درجة لون الخط</label>
          <select onchange="document.documentElement.style.setProperty('--text-opacity', this.value)" class="w-full p-2 border rounded">
            <option value="0.7">منخفضة</option>
            <option value="0.85">متوسطة</option>
            <option value="1" selected>مرتفعة</option>
          </select>
        </div>
      </div>
      <!-- شريط التنسيق بأيقونات Font Awesome -->
<div class="flex justify-center items-center gap-4 pt-4 border-t">
  <!-- غامق/B -->
  <button id="bold-btn" class="px-2 py-1 border rounded focus:outline-none">
    <i class="fa-solid fa-bold text-xl"></i>
  </button>

  <!-- محاذاة لليسار -->
  <button id="left-btn" class="px-2 py-1 border rounded focus:outline-none">
    <i class="fa-solid fa-align-left text-xl"></i>
  </button>

  <!-- محاذاة للمنتصف -->
  <button id="center-btn" class="px-2 py-1 border rounded focus:outline-none">
    <i class="fa-solid fa-align-center text-xl"></i>
  </button>

  <!-- محاذاة لليمين -->
  <button id="right-btn" class="px-2 py-1 border rounded focus:outline-none">
    <i class="fa-solid fa-align-right text-xl"></i>
  </button>
</div>
    </div>
  </div>  <!-- سكربت المنع -->  <script>
    document.addEventListener('copy', e => e.preventDefault());
    document.addEventListener('contextmenu', e => e.preventDefault());
    document.addEventListener('keydown', e => {
      if ((e.ctrlKey && ['c','u','s'].includes(e.key.toLowerCase())) || e.key==='F12') e.preventDefault();
    });
  </script>
  <!-- سكربت الوظائف -->
<script>
  // 1. تغيير حجم الخط وحفظ الإعداد
  function setFontSize(size) {
    document.documentElement.style.setProperty('--font-size', size);
    localStorage.setItem('fontSize', size);
  }

  // 2. تغيير الثيم وحفظ الإعداد
  function setTheme(theme) {
    const root = document.documentElement;
    switch (theme) {
      case 'dark':
        root.style.setProperty('--bg-color', '#1e1e1e');
        root.style.setProperty('--text-color', '#f3f4f6');
        break;
      case 'brown':
        root.style.setProperty('--bg-color', '#efdfd3');
        root.style.setProperty('--text-color', '#1f2937');
        break;
      case 'blue':
        root.style.setProperty('--bg-color', '#e0f2fe');
        root.style.setProperty('--text-color', '#1f2937');
        break;
      case 'green':
        root.style.setProperty('--bg-color', '#d1fae5');
        root.style.setProperty('--text-color', '#1f2937');
        break;
      case 'pink':
        root.style.setProperty('--bg-color', '#ffe4e6');
        root.style.setProperty('--text-color', '#1f2937');
        break;
      case 'purple':
        root.style.setProperty('--bg-color', '#ede9fe');
        root.style.setProperty('--text-color', '#1f2937');
        break;
      default:
        root.style.setProperty('--bg-color', '#f9fafb');
        root.style.setProperty('--text-color', '#1f2937');
    }
    localStorage.setItem('theme', theme);
  }

  // 3. بعد تحميل الصفحة، نربط جميع الأحداث
  document.addEventListener('DOMContentLoaded', () => {
    // استعادة الإعدادات
    const fs      = localStorage.getItem('fontSize'),
          th      = localStorage.getItem('theme'),
          content = document.getElementById('content'),
          prog    = document.getElementById('progress'),
          btnTop  = document.getElementById('toTop');

    if (fs) setFontSize(fs);
    if (th) setTheme(th);

    // شريط التقدم وزر الرجوع للأعلى
    window.addEventListener('scroll', () => {
      const h = document.documentElement;
      prog.style.width = (window.scrollY / (h.scrollHeight - h.clientHeight) * 100) + '%';
      btnTop?.classList.toggle('hidden', window.scrollY < 300);
    });
    btnTop?.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));

    // مودال إعدادات القارئ
    const openBtn  = document.getElementById('open-settings'),
          closeBtn = document.getElementById('close-settings'),
          modal    = document.getElementById('reader-settings-modal');
    openBtn.addEventListener('click', () => modal.classList.toggle('hidden'));
    closeBtn.addEventListener('click', () => modal.classList.add('hidden'));
    modal.addEventListener('click', e => { if (e.target === modal) modal.classList.add('hidden'); });

    // **** زرّ الـ B و أزرار المحاذاة مع تأثير التفعيل ****
document.addEventListener('DOMContentLoaded', () => {
  const content = document.getElementById('content');
  const btns = {
    bold:   document.getElementById('bold-btn'),
    left:   document.getElementById('left-btn'),
    center: document.getElementById('center-btn'),
    right:  document.getElementById('right-btn')
  };

  // وظيفة تزيل التأثير عن جميع الأزرار
  function clearActive() {
    Object.values(btns).forEach(b => b.classList.remove('active-btn'));
  }

  // B: toggle غامق/عادي مع تأثير
  btns.bold.addEventListener('click', () => {
    if (content.style.fontWeight === 'bold') {
      content.style.fontWeight = 'normal';
      btns.bold.classList.remove('active-btn');
    } else {
      content.style.fontWeight = 'bold';
      clearActive();
      btns.bold.classList.add('active-btn');
    }
  });

  // محاذاة النص مع إبراز الزر
  btns.left.addEventListener('click', () => {
    content.style.textAlign = 'left';
    clearActive();
    btns.left.classList.add('active-btn');
  });
  btns.center.addEventListener('click', () => {
    content.style.textAlign = 'center';
    clearActive();
    btns.center.classList.add('active-btn');
  });
  btns.right.addEventListener('click', () => {
    content.style.textAlign = 'right';
    clearActive();
    btns.right.classList.add('active-btn');
  });
});
</script>  <!-- تهيئة Lottie -->  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const reactions = ['like','love','haha','sad','angry'];
      reactions.forEach(type => {
        const container = document.getElementById(`${type}-lottie`);
        if (!container) return;
        const anim = lottie.loadAnimation({ container, renderer:'svg', loop:false, autoplay:false, path:`/animations/${type}.json` });
        container.addEventListener('mouseenter', () => anim.play());
        container.addEventListener('mouseleave', () => anim.goToAndStop(0,true));
        container.parentElement.addEventListener('click', () => {
          anim.play();
          const span = container.parentElement.querySelector('.count');
          span.textContent = +span.textContent + 1;
        });
      });
    });
  </script>  <!-- plugin.js الأصلي -->  <script src="../js/plugin.js"></script></body>
        </html>
